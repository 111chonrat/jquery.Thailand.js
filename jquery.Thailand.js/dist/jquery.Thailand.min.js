/**
 * @name jquery.Thailand.js
 * @version 1.3.3
 * @update Apr 16, 2017
 * @website https://github.com/earthchie/jquery.Thailand.js
 * @license WTFPL v.2 - http://www.wtfpl.net/
 *
 * @dependency: jQuery <https://jquery.com/>
 *              typeahead.js <https://twitter.github.io/typeahead.js/>
 *              JQL.js <https://github.com/earthchie/JQL.js>
 **/
$.Thailand=function(a){"use strict";a=$.extend({database:"./db.json",autocomplete_size:20,onLoad:function(){},onDataFill:function(){},$district:!1,$amphoe:!1,$province:!1,$zipcode:!1,$search:!1},a);var b=function(a){function e(a){function e(a){var b=a.charCodeAt(0);return c[b<97?b-65:26+b-97]}return d?("number"==typeof a&&(a=b[a]),a.replace(/[A-Z]/gi,e)):a}var b=[],c=[],d=!1;if(a.lookup&&a.words&&(d=!0,b=a.lookup.split("|"),c=a.words.split("|"),a=a.data),!a[0].length)return a;var f=[];return a.forEach(function(a){var b=a[0];a[1].forEach(function(a){var c=a[0];a[1].forEach(function(a){var d=a[0];(a[1]instanceof Array?a[1]:[a[1]]).forEach(function(a){f.push({d:e(d),a:e(c),p:e(b),z:a})})})})}),f};$.getJSON(a.database,function(c){var d=new JQL(b(c)),e={hint:!0,highlight:!0,minLength:1},f={empty:" ",suggestion:function(a){return"<div>"+a.d+" » "+a.a+" » "+a.p+" » "+(a.z||"<i>ไม่มีรหัสไปรษณีย์</i>")+"</div>"}},g=function(b,c){a.$district&&a.$district.val(c.d).trigger("change"),a.$amphoe&&a.$amphoe.val(c.a).trigger("change"),a.$province&&a.$province.val(c.p).trigger("change"),a.$zipcode&&a.$zipcode.val(c.z).trigger("change"),"function"==typeof a.onDataFill&&a.onDataFill({district:c.d,amphoe:c.a,province:c.p,zipcode:c.z})};a.$district&&a.$district.typeahead(e,{limit:a.autocomplete_size,templates:f,source:function(a,b){var c=[];try{c=d.select("*").where("d").match("^"+a).orderBy("d").fetch()}catch(a){}b(c)},display:function(a){return a.d}}),a.$amphoe&&a.$amphoe.typeahead(e,{limit:a.autocomplete_size,templates:f,source:function(a,b){var c=[];try{c=d.select("*").where("a").match("^"+a).orderBy("a").fetch()}catch(a){}b(c)},display:function(a){return a.a}}),a.$province&&a.$province.typeahead(e,{limit:a.autocomplete_size,templates:f,source:function(a,b){var c=[];try{c=d.select("*").where("p").match("^"+a).orderBy("p").fetch()}catch(a){}b(c)},display:function(a){return a.p}}),a.$zipcode&&a.$zipcode.typeahead(e,{limit:a.autocomplete_size,templates:f,source:function(a,b){var c=[];try{c=d.select("*").where("z").match("^"+a).orderBy("z").fetch()}catch(a){}b(c)},display:function(a){return a.z}}),a.$search&&a.$search.typeahead(e,{limit:a.autocomplete_size,templates:f,source:function(a,b){var e,c=[];try{c=new JQL(c.concat(d.select("*").where("d").match("^"+a).fetch()).concat(d.select("*").where("a").match("^"+a).fetch()).concat(d.select("*").where("p").match("^"+a).fetch()).concat(d.select("*").where("z").match("^"+a).fetch()).filter(function(a,b,c){var d=!0;for(e=0;e<c.length;e++)b!==e&&c[e].a==a.d&&c[e].d===a.d&&(d=!1);return d})).select("*").orderBy("d").fetch()}catch(a){}b(c)},display:function(a){return""}}),a.$district&&a.$district.bind("typeahead:select typeahead:autocomplete",g),a.$amphoe&&a.$amphoe.bind("typeahead:select typeahead:autocomplete",g),a.$province&&a.$province.bind("typeahead:select typeahead:autocomplete",g),a.$zipcode&&a.$zipcode.bind("typeahead:select typeahead:autocomplete",g),a.$search&&a.$search.bind("typeahead:select typeahead:autocomplete",g),"function"==typeof a.onLoad&&a.onLoad(),"function"==typeof a.onComplete&&a.onComplete()}).fail(function(b){throw new Error('File "'+a.database+'" is not exists.')})};